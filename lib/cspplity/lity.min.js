!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],function($){return t(e,$)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,require("jquery")):e.cspplity=t(e,e.jQuery||e.Zepto)}("undefined"!=typeof window?window:this,function(e,$){"use strict";function t(e){var t=D();return F&&e.length?(e.one(F,t.resolve),setTimeout(t.resolve,500)):t.resolve(),t.promise()}function n(e,t,n){if(1===arguments.length)return $.extend({},e);if("string"==typeof t){if(void 0===n)return void 0===e[t]?null:e[t];e[t]=n}else $.extend(e,t);return this}function i(e){for(var t=decodeURI(e.split("#")[0]).split("&"),n={},i,o=0,r=t.length;o<r;o++)t[o]&&(i=t[o].split("="),n[i[0]]=i[1]);return n}function o(e,t){return e+(e.indexOf("?")>-1?"&":"?")+$.param(t)}function r(e,t){var n=e.indexOf("#");return-1===n?t:(n>0&&(e=e.substr(n)),t+e)}function a(e){return $('<span class="cspplity-error"/>').append(e)}function s(e,t){var n=t.opener()&&t.opener().data("cspplity-desc")||"Image with no description",i=$('<img src="'+e+'" alt="'+n+'"/>'),o=D(),r=function(){o.reject(a("Failed loading image"))};return i.on("load",function(){if(0===this.naturalWidth)return r();o.resolve(i)}).on("error",r),o.promise()}function l(e,t){var n,i,o;try{n=$(e)}catch(e){return!1}return!!n.length&&(i=$('<i style="display:none !important"/>'),o=n.hasClass("cspplity-hide"),t.element().one("cspplity:remove",function(){i.before(n).remove(),o&&!n.closest(".cspplity-content").length&&n.addClass("cspplity-hide")}),n.removeClass("cspplity-hide").after(i))}function c(e){var t=K.exec(e);return!!t&&f(r(e,o("https://www.youtube"+(t[2]||"")+".com/embed/"+t[4],$.extend({autoplay:1},i(t[5]||"")))))}function p(e){var t=M.exec(e);return!!t&&f(r(e,o("https://player.vimeo.com/video/"+t[3],$.extend({autoplay:1},i(t[4]||"")))))}function d(e){var t=A.exec(e);return!!t&&(0!==e.indexOf("http")&&(e="https:"+e),f(r(e,o("https://www.facebook.com/plugins/video.php?href="+e,$.extend({autoplay:1},i(t[4]||""))))))}function u(e){var t=P.exec(e);return!!t&&f(r(e,o("https://www.google."+t[3]+"/maps?"+t[6],{output:t[6].indexOf("layer=c")>0?"svembed":"embed"})))}function f(e){return'<div class="cspplity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+e+'"/></div>'}function y(){return E.documentElement.clientHeight?E.documentElement.clientHeight:Math.round(j.height())}function v(e){var t=w();t&&(27===e.keyCode&&t.close(),9===e.keyCode&&m(e,t))}function m(e,t){var n=t.element().find(W),i=n.index(E.activeElement);e.shiftKey&&i<=0?(n.get(n.length-1).focus(),e.preventDefault()):e.shiftKey||i!==n.length-1||(n.get(0).focus(),e.preventDefault())}function h(){$.each(T,function(e,t){t.resize()})}function g(e){1===T.unshift(e)&&(z.addClass("cspplity-active"),j.on({resize:h,keydown:v})),$("body > *").not(e.element()).addClass("cspplity-hidden").each(function(){var e=$(this);void 0===e.data(q)&&e.data(q,e.attr(O)||null)}).attr(O,"true")}function b(e){var t;e.element().attr(O,"true"),1===T.length&&(z.removeClass("cspplity-active"),j.off({resize:h,keydown:v})),T=$.grep(T,function(t){return e!==t}),t=T.length?T[0].element():$(".cspplity-hidden"),t.removeClass("cspplity-hidden").each(function(){var e=$(this),t=e.data(q);t?e.attr(O,t):e.removeAttr(O),e.removeData(q)})}function w(){return 0===T.length?null:T[0]}function x(e,t,n,i){var o="inline",r,a=$.extend({},n);return i&&a[i]?(r=a[i](e,t),o=i):($.each(["inline","iframe"],function(e,t){delete a[t],a[t]=n[t]}),$.each(a,function(n,i){return!i||(!(!i.test||i.test(e,t))||(r=i(e,t),!1!==r?(o=n,!1):void 0))})),{handler:o,content:r||""}}function C(e,i,o,r){function a(e){u=$(e).css("max-height",y()+"px"),d.find(".cspplity-loader").each(function(){var e=$(this);t(e).always(function(){e.remove()})}),d.removeClass("cspplity-loading").find(".cspplity-content").empty().append(u),c=!0,u.trigger("cspplity:ready",[s])}var s=this,l,c=!1,p=!1,d,u;i=$.extend({},H,i),d=$(i.template),s.element=function(){return d},s.opener=function(){return o},s.options=$.proxy(n,s,i),s.handlers=$.proxy(n,s,i.handlers),s.resize=function(){c&&!p&&u.css("max-height",y()+"px").trigger("cspplity:resize",[s])},s.close=function(){if(c&&!p){p=!0,b(s);var e=D();if(r&&(E.activeElement===d[0]||$.contains(d[0],E.activeElement)))try{r.focus()}catch(e){}return u.trigger("cspplity:close",[s]),d.removeClass("cspplity-opened").addClass("cspplity-closed"),t(u.add(d)).always(function(){u.trigger("cspplity:remove",[s]),d.remove(),d=void 0,e.resolve()}),e.promise()}},l=x(e,s,i.handlers,i.handler),d.attr(O,"false").addClass("cspplity-loading cspplity-opened cspplity-"+l.handler).appendTo("body").focus().on("click","[data-cspplity-close]",function(e){$(e.target).is("[data-cspplity-close]")&&s.close()}).trigger("cspplity:open",[s]),g(s),$.when(l.content).always(a)}function k(e,t,n){e.preventDefault?(e.preventDefault(),n=$(this),e=n.data("cspplity-target")||n.attr("href")||n.attr("src")):n=$(n);var i=new C(e,$.extend({},n.data("cspplity-options")||n.data("cspplity"),t),n,E.activeElement);if(!e.preventDefault)return i}var E=e.document,j=$(e),D=$.Deferred,z=$("html"),T=[],O="aria-hidden",q="cspplity-"+O,W='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',H={handler:null,handlers:{image:s,inline:l,youtube:c,vimeo:p,googlemaps:u,facebookvideo:d,iframe:f},template:'<div class="cspplity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="cspplity-wrap" data-cspplity-close role="document"><div class="cspplity-loader" aria-hidden="true">Loading...</div><div class="cspplity-container"><div class="cspplity-content"></div><button class="cspplity-close" type="button" aria-label="Close (Press escape to close)" data-cspplity-close>&times;</button></div></div></div>'},I=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,K=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i,M=/(vimeo(pro)?.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/,P=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i,A=/(facebook\.com)\/([a-z0-9_-]*)\/videos\/([0-9]*)(.*)?$/i,F=function(){var e=E.createElement("div"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return t[n];return!1}();return s.test=function(e){return I.test(e)},k.version="2.2.2",k.options=$.proxy(n,k,H),k.handlers=$.proxy(n,k,H.handlers),k.current=w,$(E).on("click.cspplity","[data-cspplity]",k),k});